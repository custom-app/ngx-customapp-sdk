<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>ngx-customapp-sdk</title><meta name="description" content="Documentation for ngx-customapp-sdk"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">ngx-customapp-sdk</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1> ngx-customapp-sdk</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#ngx-customapp-sdk" id="ngx-customapp-sdk" style="color: inherit; text-decoration: none;">
  <h1>ngx-customapp-sdk</h1>
</a>
<p>SDK allowing you to quickly setup authorization and websocket life cycle in an Angular app. Some utils are also included</p>

<a href="#contents" id="contents" style="color: inherit; text-decoration: none;">
  <h1>Contents</h1>
</a>
<ul>
<li><a href="#whats-included">What&#39;s included</a></li>
<li><a href="#package-structure">Package structure</a><ul>
<li><a href="#customapp-rxjs-websocket">customapp-rxjs-websocket</a></li>
<li><a href="#ngx-customapp-jwt">ngx-customapp-jwt</a></li>
<li><a href="#ngx-customapp-errors">ngx-customapp-errors</a></li>
<li><a href="#ngx-customapp-proto-http">ngx-customapp-proto-http</a></li>
<li><a href="#ngx-customapp-pattern-auth-before-socket">ngx-customapp-pattern-auth-before-socket</a></li>
</ul>
</li>
</ul>

<a href="#what39s-included" id="what39s-included" style="color: inherit; text-decoration: none;">
  <h1>What&#39;s included.</h1>
</a>
<p>Suited for Angular.</p>
<ul>
<li>Supports a custom message serialization and usage of custom models (
e.g. <a href="https://www.npmjs.com/package/typedoc-ngx-theme">protobuff</a>).</li>
<li>A websocket life cycle management with authorization and without.</li>
<li>Supports multiple sockets and conditionally opening them in a specified order.</li>
<li>JWT and authorization headers management, refreshing jwt before opening sockets and before each request.</li>
<li>Login, logout functions and account management in the context of authorization.</li>
<li>Supports logging in as another user (admin can log in as client and log out back to admin).</li>
<li>Error handling.</li>
</ul>

<a href="#package-structure" id="package-structure" style="color: inherit; text-decoration: none;">
  <h1>Package structure</h1>
</a>
<p>There are packages, their requirements and exported functionality listed below.</p>

<a href="#customapp-rxjs-websocket" id="customapp-rxjs-websocket" style="color: inherit; text-decoration: none;">
  <h2>customapp-rxjs-websocket</h2>
</a>
<p>A package for a websocket life cycle management.</p>
<p><a href="https://custom-app.github.io/ngx-customapp-sdk/interfaces/packages_rxjs_websocket_src.WebSocketControllerConfig.html">Documentation starts here</a></p>
<p>This package:</p>
<ul>
<li>Is not only an Angular package.</li>
<li>Based on RxJs.</li>
<li>Works with a single type for request messages and a single type for response messages.</li>
<li>Support an auto reconnect. That is a part of the error handling, cos usually there is no way to handle the socket
error, other than just reopen socket.</li>
<li>A support for a request buffer. A support for not adding requests to the buffer, different buffers for authorized and
unauthorized requests, and a support for setting the queue length.</li>
<li>Supports sending an authorization request(s) just after the opening. Reconnect have to repeat the autorization.</li>
<li>Supports sending a subscription request(s) just after the authorization.</li>
<li>Counts successful and unsuccessful opening tries.</li>
<li>Offers subscriptions for states: pending, opened, authorized, subscribed, closing, closed.</li>
<li>Support for custom serializer and deserializer.</li>
<li>Functions for request-response pattern.</li>
</ul>

<a href="#ngx-customapp-jwt" id="ngx-customapp-jwt" style="color: inherit; text-decoration: none;">
  <h2>ngx-customapp-jwt</h2>
</a>
<p>A package for an authorization and a JWT management.</p>
<p><a href="https://custom-app.github.io/ngx-customapp-sdk/interfaces/angular_packages_projects_ngx_customapp_jwt_src_public_api.JwtConfig.html">Documentation starts here</a></p>
<p>This package:</p>
<ul>
<li>Is an Angular package.</li>
<li>Based on RxJs and NgRx.</li>
<li>Stores the JWT in the localStorage.</li>
<li>Provides an http interceptor, which can pin the JWT to every http request and refresh it, if necessary.</li>
<li>Provides a <code>JwtService</code> which is responsible for maintaining tokens fresh.</li>
<li>Provides store for logging in, sending auth request, saving an account info, logging out.</li>
<li>Supports logging in as another user.</li>
</ul>

<a href="#ngx-customapp-errors" id="ngx-customapp-errors" style="color: inherit; text-decoration: none;">
  <h2>ngx-customapp-errors</h2>
</a>
<p>A package for handling errors according to our own conventions.</p>
<p><a href="https://custom-app.github.io/ngx-customapp-sdk/interfaces/angular_packages_projects_ngx_customapp_errors_src_public_api.ErrorsConfig.html">Documentation starts here</a></p>
<p>This package:</p>
<ul>
<li>Is an Angular package.</li>
<li>Reports all errors, except ones from doNoSend list, to the backend.</li>
<li>Works with normalized error strings.</li>
<li>Just after handling and reporting the error, it is transformed into a human-readable error and shown to the user.</li>
</ul>

<a href="#ngx-customapp-proto-http" id="ngx-customapp-proto-http" style="color: inherit; text-decoration: none;">
  <h2>ngx-customapp-proto-http</h2>
</a>
<p>A package that handle details of working with proto over http. Helps to manage headers, errors, serialization,
deserialization.</p>
<p><a href="https://custom-app.github.io/ngx-customapp-sdk/interfaces/angular_packages_projects_ngx_customapp_proto_http_src_public_api.ProtoHttpConfig.html">Documentation starts here</a></p>
<p>This package:</p>
<ul>
<li>Is an Angular package.</li>
<li>Depends on ngx-customapp-errors and ngx-customapp-jwt (integration with authorization).</li>
<li>Based on RxJs.</li>
<li>Provides <code>RequestService</code> for sending http request.</li>
<li>Optional version interceptor, to add a version header to every http request.</li>
<li>Utils for handling different types of body when parsing proto response.</li>
</ul>

<a href="#ngx-customapp-pattern-auth-before-socket" id="ngx-customapp-pattern-auth-before-socket" style="color: inherit; text-decoration: none;">
  <h2>ngx-customapp-pattern-auth-before-socket</h2>
</a>
<p>Connects together rxjs-websocket and jwt packages to implement pattern &quot;Auth before an authorized or unauthorized
socket&quot;.</p>
<p><a href="https://custom-app.github.io/ngx-customapp-sdk/interfaces/angular_packages_projects_ngx_customapp_pattern_auth_before_socket_src_public_api.WebSocketChain.html">Documentation starts here</a></p>
<p>This package:</p>
<ul>
<li>Is an Angular package.</li>
<li>Depends on customapp-rxjs-websocket and ngx-customapp-jwt packages.</li>
<li>Based on RxJs and NgRx</li>
<li>Provides actions to init sockets and close. Sockets support the auto reconnect and the message buffer.</li>
<li>Supports opening multiple sockets concurrently and in sequence.</li>
</ul>
<p>Implemented flow:</p>
<ul>
<li>The user logs in.</li>
<li>An http request with user credentials is sent to the backend.</li>
<li>An http response with JWT and maybe user info is received.</li>
<li>JWT tokens being saved and included in headers of every request (except explicitly stated).</li>
<li>The socket opened.</li>
<li>An optional auth request is sent in the socket.</li>
<li>An auth response received from the socket.</li>
<li>Optional Subscription requests are sent in the socket.</li>
<li>Subscription responses received from the socket.</li>
<li>Optionally more sockets are opened and more auth and subscription messages are sent.</li>
<li>The user can log out, logout from every device, maybe log in as another user.</li>
<li>After logout all the sockets are closed.</li>
</ul>

<a href="#development" id="development" style="color: inherit; text-decoration: none;">
  <h1>Development</h1>
</a>

<a href="#initial-setup" id="initial-setup" style="color: inherit; text-decoration: none;">
  <h2>Initial setup</h2>
</a>
<p>Install deps for non-angular packages.</p>
<pre><code class="language-shell"><span class="hl-0">yarn</span>
</code></pre>
<p>Install deps for angular packages.</p>
<pre><code class="language-shell"><span class="hl-1">cd</span><span class="hl-0"> angular-packages</span><br/><span class="hl-0">yarn</span>
</code></pre>
<p>Build all packages.</p>
<pre><code class="language-shell"><span class="hl-2"># go to the project root</span><br/><span class="hl-1">cd</span><span class="hl-0"> ..</span><br/><span class="hl-0">yarn build</span>
</code></pre>

<a href="#tests" id="tests" style="color: inherit; text-decoration: none;">
  <h2>Tests</h2>
</a>
<p>Running tests in watch mode is only available per single package.
For example, customapp-rxjs-websocket</p>
<pre><code class="language-shell"><span class="hl-1">cd</span><span class="hl-0"> packages/rxjs-websocket</span><br/><span class="hl-0">yarn </span><span class="hl-1">test</span>
</code></pre>
<p>To run the tests for all packages once, use this command.</p>
<pre><code class="language-shell"><span class="hl-0">yarn test-ci</span>
</code></pre>

<a href="#publishing" id="publishing" style="color: inherit; text-decoration: none;">
  <h2>Publishing</h2>
</a>
<p>To set version of all packages to 1.2.3, run</p>
<pre><code class="language-shell"><span class="hl-0">yarn set-version 1.2.3</span>
</code></pre>
<p>To publish all packages, run</p>
<pre><code class="language-shell"><span class="hl-0">yarn publish</span>
</code></pre>

<a href="#adding-a-new-angular-package" id="adding-a-new-angular-package" style="color: inherit; text-decoration: none;">
  <h2>Adding a new Angular package</h2>
</a>
<p>Create a new library in the Angular workspace. Package name should be prefixed with <code>ngx-customapp-</code></p>
<pre><code class="language-shell"><span class="hl-1">cd</span><span class="hl-0"> angular-packages</span><br/><span class="hl-0">ng g library ngx-customapp-jwt</span>
</code></pre>
<p>Add watch:pkg, build:pkg and test:pkg scripts to package.json</p>
<pre><code class="language-json"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-3">&quot;scripts&quot;</span><span class="hl-0">: {</span><br/><span class="hl-0">    </span><span class="hl-3">&quot;watch:jwt&quot;</span><span class="hl-0">: </span><span class="hl-4">&quot;yarn build:jwt --watch --configuration=development&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-3">&quot;build:jwt&quot;</span><span class="hl-0">: </span><span class="hl-4">&quot;ng build ngx-customapp-jwt&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-3">&quot;test:jwt&quot;</span><span class="hl-0">: </span><span class="hl-4">&quot;ng test ngx-customapp-jwt&quot;</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">}</span>
</code></pre>
<p>Modify common build script, by adding <code>&amp;&amp; yarn build:pkg &amp;&amp; yarn</code></p>
<pre><code class="language-json"><span class="hl-0">{</span><br/><span class="hl-0">  </span><span class="hl-3">&quot;scripts&quot;</span><span class="hl-0">: {</span><br/><span class="hl-0">    </span><span class="hl-3">&quot;build&quot;</span><span class="hl-0">: </span><span class="hl-4">&quot;/* ... old command */ &amp;&amp; yarn build:jwt &amp;&amp; yarn&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">}</span>
</code></pre>
<p>Done! All other common scripts should just work.</p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Modules</a></li><li class=" tsd-kind-module"><a href="modules/angular_packages_projects_ngx_customapp_errors_src_public_api.html">angular-<wbr/>packages/projects/ngx-<wbr/>customapp-<wbr/>errors/src/public-<wbr/>api</a></li><li class=" tsd-kind-module"><a href="modules/angular_packages_projects_ngx_customapp_jwt_src_public_api.html">angular-<wbr/>packages/projects/ngx-<wbr/>customapp-<wbr/>jwt/src/public-<wbr/>api</a></li><li class=" tsd-kind-module"><a href="modules/angular_packages_projects_ngx_customapp_pattern_auth_before_socket_src_public_api.html">angular-<wbr/>packages/projects/ngx-<wbr/>customapp-<wbr/>pattern-<wbr/>auth-<wbr/>before-<wbr/>socket/src/public-<wbr/>api</a></li><li class=" tsd-kind-module"><a href="modules/angular_packages_projects_ngx_customapp_proto_http_src_public_api.html">angular-<wbr/>packages/projects/ngx-<wbr/>customapp-<wbr/>proto-<wbr/>http/src/public-<wbr/>api</a></li><li class=" tsd-kind-module"><a href="modules/packages_rxjs_websocket_src.html">packages/rxjs-<wbr/>websocket/src</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li><li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li><li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li><li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li><li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li><li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>